function getCustomizedPerfilMensal(e,a){return e>=0&&e<3?perfil_mensal[e].tabela[a].valor:new Number($("#perfil-mensal-input"+(a+1)).val())/100}function totalNecessidadesEnergiaFunction(){var e=new Number($("#perfil-mensal").val()),a=new Number($("#perfil-semanal").val()),o=new Number($("#temp-req").val()),r=new Number($("#distrito").val());for(necessidades_mes=[],totalNecessidadesEnergia=0,total=0,i=0;i<meses_numero_horas.length;i++){var t=0;for(j=1;j<rowId+1;j++){var s=new Number($("#tipo-consumo-value"+j).val()),n=$("#tipo-consumo"+j).val();t+=s*consumo_diario_agua[n].valor}var c=0;if(a>=0&&a<3)c=perfil_semanal[a].valor;else if(3==a){var l=0;for(k=1;k<8;k++)l+=new Number($("#perfil-semanal-input"+k).val());c=l/7/100}necessidades_mes[i]=t*(getCustomizedPerfilMensal(e,i)*c)*meses_numero_horas[i].n_dias*(o-irradiacao_temp_amb_temp_agua[r].mesI[i].valorTempAgua)*fatores_conversao[0],totalNecessidadesEnergia+=new Number(necessidades_mes[i])}total=totalNecessidadesEnergia,correcaoOrientacao(),energiaSolarCaptada()}function correcaoOrientacao(){var e=$("#orientacao-input").val(),a=0;a=e>70?0:e>0?1.14-.0085*e:1,totalCorrecaoOrientacao=a}function getCorrecaoInclinacao(e,a){for(j=0;j<correcao_inclinacao.length;j++)if(e==correcao_inclinacao[j].latitude)return correcao_inclinacao[j].meses[a].valor}function energiaSolarCaptada(){var e=new Number($("#distrito").val()),a=new Number($("#distrito-latitude").val());for(totalEnergiaArray=[],totalEnergia=0,i=0;i<meses_numero_horas.length;i++)totalEnergiaArray[i]=(rendimento_otico*perdas[1].valor-coeficient_perdas*((temperatura_utilizacao_alto-(irradiacao_temp_amb_temp_agua[e].mesI[i].valorTempAmb+irradiacao_temp_amb_temp_agua[e].mesI[i].valorTempAgua))/(getCorrecaoInclinacao(a,i)*(totalCorrecaoOrientacao*perdas[2].valor*irradiacao_temp_amb_temp_agua[e].mesI[i].valorIrr)*(1e3*fatores_conversao[1]/meses_numero_horas[i].n_horas_sol))))*(getCorrecaoInclinacao(a,i)*(totalCorrecaoOrientacao*perdas[2].valor*irradiacao_temp_amb_temp_agua[e].mesI[i].valorIrr))*(1-perdas[0].valor)*meses_numero_horas[i].n_dias,totalEnergia+=new Number(totalEnergiaArray[i]);racio(),energiaSolarCaptada2(),energiaSolarUtilizada(),energiaSolarUtilizadaPercent(),energiaBackup(),energiaBackupPercent(),excedenteSolar(),excedenteSolarPerc(),necessidadesEnergeticaskWh(),cenarioI(),cenarioF(),reduction(),resume(),nextStep()}function racio(){totalRacio=media(necessidades_mes)/media(totalEnergiaArray)}function media(e){var a=0;for(i=0;i<e.length;i++)i>=4&&i<9&&(a+=new Number(e[i]));return a/5}function energiaSolarCaptada2(){var e=$("#coletores-reanalise").val();for(totalEnergiaArray2=[],totalEnergia2=0,i=0;i<meses_numero_horas.length;i++)totalEnergiaArray2[i]=""==e||void 0==e?totalEnergiaArray[i]*new Number((totalRacio/2.25).toFixed(0))*2.25:totalEnergiaArray[i]*e,totalEnergia2+=totalEnergiaArray2[i]}function energiaSolarUtilizada(){for(totalEnergiaSolarUtilizada=[],totalEnergiaSolar=0,i=0;i<meses_numero_horas.length;i++)totalEnergiaArray2[i]>necessidades_mes[i]?totalEnergiaSolarUtilizada[i]=necessidades_mes[i]:totalEnergiaSolarUtilizada[i]=totalEnergiaArray2[i],totalEnergiaSolar+=totalEnergiaSolarUtilizada[i]}function energiaSolarUtilizadaPercent(){for(totalEnergiaSolarUtilizadaPerc=[],totalEnergiaSolarPerc=0,i=0;i<meses_numero_horas.length;i++)totalEnergiaSolarUtilizadaPerc[i]=totalEnergiaSolarUtilizada[i]/necessidades_mes[i];totalEnergiaSolarPerc=totalEnergiaSolar/total}function energiaBackup(){for(totalEnergiaBackupMes=[],totalEnergiaBackup=0,i=0;i<meses_numero_horas.length;i++)necessidades_mes[i]-totalEnergiaArray2[i]<0?totalEnergiaBackupMes[i]=0:totalEnergiaBackupMes[i]=necessidades_mes[i]-totalEnergiaArray2[i],totalEnergiaBackup+=totalEnergiaBackupMes[i]}function energiaBackupPercent(){for(totalEnergiaBackupMesPerc=[],totalEnergiaBackupPerc=0,i=0;i<meses_numero_horas.length;i++)totalEnergiaBackupMesPerc[i]=totalEnergiaBackupMes[i]/necessidades_mes[i];totalEnergiaBackupPerc=totalEnergiaBackup/total}function excedenteSolar(){for(totalExcedenteSolarArray=[],totalExcedenteSolar=0,i=0;i<meses_numero_horas.length;i++)totalExcedenteSolarArray[i]=totalEnergiaArray2[i]-totalEnergiaSolarUtilizada[i],totalExcedenteSolar+=totalExcedenteSolarArray[i]}function excedenteSolarPerc(){for(totalExcedenteSolarArrayPerc=[],totalExcedenteSolarPerc=0,i=0;i<meses_numero_horas.length;i++)totalExcedenteSolarArrayPerc[i]=totalExcedenteSolarArray[i]/totalEnergiaArray2[i];totalExcedenteSolarPerc=totalExcedenteSolar/totalEnergia2}function necessidadesEnergeticaskWh(){for(necessidades_mes_kWh=[],total_mes_kWh=0,i=0;i<meses_numero_horas.length;i++)necessidades_mes_kWh[i]=necessidades_mes[i]*fatores_conversao[1],total_mes_kWh+=necessidades_mes_kWh[i]}function cenarioI(){var e=2==$("#rend").val()?$("#iRendMan").val():$("#rend").val(),a=$("#sis-prod").val(),o=$("#age").val(),r=$("#custo-unit-input").val(),t=0;for(cenarioI_mes=[],cenarioI_custos=[],total_cenarioI_mes=0,total_cenarioI_custos=0,t=1==e&&sistemas_prod_aqs[a].rendimento[o].nome==idades[o]?sistemas_prod_aqs[a].rendimento[o].valor:e/100,i=0;i<meses_numero_horas.length;i++)cenarioI_mes[i]=necessidades_mes_kWh[i]/t,cenarioI_custos[i]=cenarioI_mes[i]*r,total_cenarioI_mes+=cenarioI_mes[i],total_cenarioI_custos+=cenarioI_custos[i];total_cenarioI_custos=total_cenarioI_custos}function cenarioF(){var e=2==$("#rend").val()?$("#iRendMan").val():$("#rend").val(),a=$("#sis-prod").val(),o=$("#age").val(),r=$("#custo-unit-input").val(),t=0;for(cenarioF_mes=[],total_cenarioF_mes=0,cenarioF_custos=[],total_cenarioF_custos=0,t=1==e&&sistemas_prod_aqs[a].rendimento[o].nome==idades[o]?sistemas_prod_aqs[a].rendimento[o].valor:e/100,i=0;i<meses_numero_horas.length;i++)cenarioF_mes[i]=totalEnergiaBackupMes[i]*fatores_conversao[1]/t,total_cenarioF_mes+=cenarioF_mes[i],cenarioF_custos[i]=cenarioF_mes[i]*r,total_cenarioF_custos+=cenarioF_custos[i];total_cenarioF_custos=total_cenarioF_custos}function reduction(){for(reducao_mes=[],total_reducao_mes=0,reducao_percent=[],total_reduca_percent=0,i=0;i<meses_numero_horas.length;i++)reducao_mes[i]=cenarioI_custos[i]-cenarioF_custos[i],total_reducao_mes+=reducao_mes[i],reducao_percent[i]=reducao_mes[i]/cenarioI_custos[i];total_reduca_percent=total_reducao_mes/total_cenarioI_custos}function resume(){n_colectores=0,area_colectores=0,volume_acumulacao_resume=0,necess_ener_anuais=0,energia_solar=0,energia_sist_apoio=0,excedente_verao=0,fracao_solar=0,s_sist_solar=0,c_sist_solar=0,reducao_solar=0,investimento_resume=0,colectores=0,depositos_acessorios=0,instalacao=0,op_manutencao=0,periodo_retorno=0;var e=$("#coletores-reanalise").val();n_colectores=void 0!=e&&""!=e?new Number(e):new Number((totalRacio/area_coletor_solar).toFixed(0)),area_colectores=void 0==e||""==e?new Number(n_colectores*area_coletor_solar):new Number(e*area_coletor_solar),volume_acumulacao_resume=area_colectores*volume_acumulacao_info,necess_ener_anuais=total*fatores_conversao[1],energia_solar=totalEnergiaSolar*fatores_conversao[1],energia_sist_apoio=totalEnergiaBackup*fatores_conversao[1],excedente_verao=max(totalExcedenteSolarArrayPerc)>avisos[0].valor?max(totalExcedenteSolarArrayPerc):"",excedente_verao_perc=100*excedente_verao,fracao_solar=100*totalEnergiaSolarPerc,s_sist_solar=total_cenarioI_custos,c_sist_solar=total_cenarioF_custos,reducao_solar=total_reducao_mes,colectores=area_colectores<10?investimentoI[0].info[0].valor*area_colectores:area_colectores>=100?investimentoI[0].info[2].valor*area_colectores:investimentoI[0].info[1].valor*area_colectores,depositos_acessorios=volume_acumulacao_resume<500?volume_acumulacao_resume*investimentoI[1].info[0].valor:volume_acumulacao_resume>=2e3?volume_acumulacao_resume*investimentoI[1].info[2].valor:volume_acumulacao_resume*investimentoI[1].info[1].valor,instalacao=(colectores+depositos_acessorios)*investimentoI[2].valor_direto,investimento_resume=colectores+depositos_acessorios+instalacao,op_manutencao=investimento_resume*investimentoI[3].valor_direto,periodo_retorno=investimento_resume/reducao_solar,$("#n-coletores-resumo").html(n_colectores.toFixed(2)),$("#area-resumo").html(area_colectores.toFixed(2)+" m2"),$("#volume-resumo").html(volume_acumulacao_resume.toFixed(0)+" litros"),$("#nec-ener-resumo").html(necess_ener_anuais.toFixed(0)+" kWh"),$("#ener-solar-resumo").html(energia_solar.toFixed(0)+" kWh"),$("#ener-backup-resumo").html(energia_sist_apoio.toFixed(0)+" kWh"),$("#excedente-resumo").html(excedente_verao_perc.toFixed(0)+"%"),$("#fracao-resumo").html(fracao_solar.toFixed(0)+"%"),$("#s-sistema-resumo").html(s_sist_solar.toFixed(2)+" €"),$("#c-sistema-resumo").html(c_sist_solar.toFixed(2)+" €"),$("#reduc-anual-resumo").html(reducao_solar.toFixed(2)+" €"),$("#investimento-resumo").html(investimento_resume.toFixed(2)+" €"),$("#coletores-resumo").html(colectores.toFixed(2)+" €"),$("#deposito-resumo").html(depositos_acessorios.toFixed(2)+" €"),$("#instalacao-resumo").html(instalacao.toFixed(2)+" €"),$("#operacao-resumo").html(op_manutencao.toFixed(2)+" €"),$("#periodo-resumo").html(periodo_retorno.toFixed(1)+" anos"),area_colectores>avisos[1].valor?($(".area-note").html(avisos[1].mensagem),$(".area-note").show()):($(".area-note").html(""),$(".area-note").hide()),excedente_verao_perc>0&&void 0!=excedente_verao_perc&&""!=excedente_verao_perc?($(".excedente-note").html(avisos[0].mensagem),$(".excedente-note").show()):($(".excedente-note").html(""),$(".excedente-note").hide())}function max(e){var a=0;for(i=0;i<e.length;i++)e[i]>a&&(a=e[i]);return a}